{% schema %}
{
  "name": "Promo Marquee",
  "settings": [
    {
      "type": "color",
      "id": "bg_color",
      "label": "Background Color",
      "default": "#248f6f"
    },
    {
      "type": "color",
      "id": "text_color",
      "label": "Text Color",
      "default": "#ffffff"
    },
    {
      "type": "text",
      "id": "text_1",
      "label": "Text 1",
      "default": "4–5 business day delivery"
    },
    {
      "type": "text",
      "id": "text_2",
      "label": "Text 2",
      "default": "Canada-wide bulk shipping"
    },
    {
      "type": "range",
      "id": "speed",
      "label": "Animation Speed (seconds)",
      "min": 10,
      "max": 200,
      "step": 2,
      "default": 60
    },
    {
      "type": "range",
      "id": "font_size",
      "label": "Font Size (px)",
      "min": 12,
      "max": 30,
      "step": 1,
      "default": 16
    },
    {
      "type": "range",
      "id": "gap",
      "label": "Gap between items (px)",
      "min": 0,
      "max": 50,
      "step": 1,
      "default": 10
    }
  ],
  "presets": [
    {
      "name": "Promo Marquee"
    }
  ]
}
{% endschema %}

<style>
  @import url('https://fonts.googleapis.com/css2?family=Rethink+Sans:ital,wght@0,400..800;1,400..800&display=swap');

  .promo-marquee-section {
    background-color: {{ section.settings.bg_color }};
    color: {{ section.settings.text_color }};
    overflow: hidden;
    white-space: nowrap;
    position: relative;
    padding: 15px 0;
    font-family: 'Rethink Sans', sans-serif;
  }

  .promo-marquee-track {
    display: inline-flex;
    animation: marquee {{ section.settings.speed }}s linear infinite;
    /* Determine width dynamically or ensure enough content */
    /* For method: translate -50%, we need content to be exactly doubled */
    width: max-content; 
  }

  .promo-marquee-content {
    display: inline-flex;
    align-items: center;
  }

  .promo-marquee-item {
    font-size: {{ section.settings.font_size }}px;
    font-weight: 500;
    margin: 0 {{ section.settings.gap }}px; /* Adjust spacing between items */
    display: inline-flex;
    align-items: center;
  }
  
  .promo-marquee-item .bullet {
    margin: 0 {{ section.settings.gap }}px;
    font-size: 0.8em;
    opacity: 0.8;
  }

  @keyframes marquee {
    0% {
      transform: translateX(0);
    }
    100% {
      transform: translateX(-50%);
    }
  }

  /* Pause on hover optional */
  .promo-marquee-section:hover .promo-marquee-track {
    animation-play-state: paused;
  }

  @media screen and (max-width: 768px) {
    .promo-marquee-section {
      padding: 10px 0;
    }

    .promo-marquee-item {
      font-size: calc({{ section.settings.font_size }}px - 2px);
    }
  }
</style>

<div class="promo-marquee-section">
  <div class="promo-marquee-track">
    {%- comment -%}
      We repeat the pair of texts multiple times to form a "set".
      Then we output the "set" twice to allow for the -50% translation loop.
      A set of 10 repetitions should cover even very wide 4k screens.
    {%- endcomment -%}

    {%- capture marquee_set -%}
      {%- for i in (1..10) -%}
        <div class="promo-marquee-item">
          <span>{{ section.settings.text_1 }}</span>
          <span class="bullet">•</span>
          <span>{{ section.settings.text_2 }}</span>
          <span class="bullet">•</span>
        </div>
      {%- endfor -%}
    {%- endcapture -%}

    <!-- First Set -->
    <div class="promo-marquee-content">
      {{ marquee_set }}
    </div>

    <!-- Duplicate Set for looping -->
    <div class="promo-marquee-content">
      {{ marquee_set }}
    </div>
  </div>
</div>
